{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tigray Data Repository</title>
    <link
      rel="shortcut icon"
      href="{% static 'img/Tigray_logo2.png' %}"
      type="image/x-icon"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/typicons/2.1.2/typicons.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bs-custom-file-input@1.4.1/dist/bs-custom-file-input.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{% static 'admin_static/css/adminlte.min.css' %}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css"
    />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
  </head>

  <body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
      <nav
        class="main-header navbar navbar-expand navbar-light navbar-light nav-fixed"
      >
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"
              ><i class="fas fa-bars"></i
            ></a>
          </li>
        </ul>
      </nav>

      <aside
        class="main-sidebar sidebar-dark-primary elevation-4"
        style="background-color: black"
      >
        <img
          src="{% static 'img/output-onlinepngtools.png' %}"
          alt="Tigray Data Repository Logo"
          class="brand-image text-center"
          style="opacity: 1; width: 80%"
        />
        <div class="sidebar">
          <div class="user-panel mt-3 pb-3 mb-3 d-flex">
            <div class="image">
              <img
                src="{{ request.user.adminpic.profile_pic.url }}"
                class="img-circle elevation-2"
                alt="User Image"
                style="height: 37px"
              />
            </div>
            <div class="info">
              <a href="#" class="d-block"
                >{{ request.user.first_name }} {{ request.user.last_name }}</a
              >
            </div>
          </div>

          <div class="form-inline">
            <div class="input-group" data-widget="sidebar-search">
              <input
                class="form-control form-control-sidebar"
                type="search"
                placeholder="Search"
                aria-label="Search"
                style="background-color: black"
              />
              <div class="input-group-append" style="background-color: black">
                <button class="btn btn-sidebar">
                  <i class="fas fa-search fa-fw"></i>
                </button>
              </div>
            </div>
          </div>

          <nav class="mt-2">
            <ul
              class="nav nav-pills nav-sidebar flex-column"
              data-widget="treeview"
              role="menu"
              data-accordion="false"
            >
              <li class="nav-item">
                <a
                  href="{% url 'dashboard-page' %}"
                  class="nav-link {% if request.resolver_match.url_name == 'dashboard-page' %}active{% endif %}"
                >
                  <i class="nav-icon far typcn typcn-home"></i>
                  <p>Dashboard</p>
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="{% url 'dataset-groups' %}"
                  class="nav-link {% if request.resolver_match.url_name == 'dataset-groups' %}active{% endif %}"
                >
                  <i class="nav-icon fa fa-folder"></i>
                  <p>Repo Management</p>
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="{% url 'add-dataset-item' %}"
                  class="nav-link {% if request.resolver_match.url_name == 'add-dataset-item' %}active{% endif %}"
                >
                  <i class="nav-icon fa fa-file"></i>
                  <p>File Management</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link {% if request.resolver_match.url_name == 'add-initiative' or request.resolver_match.url_name == 'display-initiatives' %}active{% endif %}">
                  <i class="nav-icon fa fa-building"></i>
                  <p>
                    Diaspora Initiatives <i class="fas fa-angle-left right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a
                      href="{% url 'add-initiative' %}"
                      class="nav-link {% if request.resolver_match.url_name == 'add-initiative' %}active{% endif %}"
                    >
                      <i class="far fa-circle nav-icon"></i>
                      <p>Add Data</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="{% url 'display-initiatives' %}" class="nav-link {% if request.resolver_match.url_name == 'display-initiatives' %}active{% endif %}">
                      <i class="far fa-circle nav-icon"></i>
                      <p>Manage Data</p>
                    </a>
                  </li>
                </ul>
              </li>
              {% if request.user.is_superuser %}
              <li class="nav-item">
                <a
                  href="{% url 'admin-management' %}"
                  class="nav-link {% if request.resolver_match.url_name == 'admin-management' %}active{% endif %}"
                >
                  <i class="nav-icon fa fa-users"></i>
                  <p>Admin Management</p>
                </a>
              </li>
              {% endif %}
              <li class="nav-item">
                <a
                  href="{% url 'account-settings' %}"
                  class="nav-link {% if request.resolver_match.url_name == 'account-settings' %}active{% endif %}"
                >
                  <i class="nav-icon fa fa-gear"></i>
                  <p>Settings</p>
                </a>
              </li>
              <li class="nav-item">
                <a onclick="confirmLogout()" class="nav-link">
                  <i class="nav-icon fa fa-sign-out"></i>
                  <p>Sign out</p>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </aside>

      {% block content %} {% endblock %}

      <footer class="main-footer">
        <b
          >Copyright &copy;
          <script>
            document.write(new Date().getFullYear());
          </script>
          <a href="{% url 'index' %}" target="_blank">Tigray Data Repository</a
          >.
        </b>
      </footer>

      <aside class="control-sidebar control-sidebar-dark"></aside>
    </div>

    <script src="{% static 'admin_static/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'admin_static/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="{% static 'admin_static/js/adminlte.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>

    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
    <!-- DataTables Buttons JS -->
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>

    <script>
      function confirmLogout() {
        Swal.fire({
          title: "Are you sure?",
          text: `Are you sure you want to signout?`,
          showCancelButton: true,
          confirmButtonColor: "#7066e0",
          cancelButtonColor: "#d33",
          confirmButtonText:
            'Continue <span class="fa fa-arrow-right"></span> ',
          cancelButtonText: "Cancel",
        }).then((result) => {
          if (result.isConfirmed) {
            const form = document.createElement("form");
            form.action = `/logout`;
            form.innerHTML = `{% csrf_token %}`;
            document.body.appendChild(form);
            form.submit();
          }
        });
      }
    </script>

    <!-- Repository Group Registration form validation with jquery validation -->
    <script>
      $(function () {
        $("#RepositoryGroupForm").validate({
          rules: {
            repository_name: {
              required: true,
            },
            repository_description: {
              required: true,
            },
          },
          messages: {
            repository_name: {
              required: "Please enter a repository name",
            },
            repository_description: {
              required: "Please provide a short repository description",
            },
          },
          errorElement: "span",
          errorPlacement: function (error, element) {
            error.addClass("invalid-feedback");
            element.closest(".form-group").append(error);
          },
          highlight: function (element, errorClass, validClass) {
            $(element).addClass("is-invalid");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass("is-invalid");
          },
        });
      });
    </script>

    <!--  Password update form validation with jquery validation -->
    <script>
      $(function () {
        $("#PasswordValidation").validate({
          rules: {
            CurrentPassword: {
              required: true,
            },
            NewPassword: {
              required: true,
              minlength: 6,
            },
            ConfirmNewPassword: {
              required: true,
              equalTo: "#NewPassword",
            },
          },
          messages: {
            CurrentPassword: {
              required: "Please enter the current password",
            },
            NewPassword: {
              required: "Please provide a new password",
              minlength: "Your password must be at least 6 characters long",
            },
            ConfirmNewPassword: {
              required: "Please confirm the new password",
              equalTo:
                "Passwords do not match. Please ensure both fields are the same.",
            },
          },
          errorElement: "span",
          errorPlacement: function (error, element) {
            error.addClass("invalid-feedback");
            element.closest(".form-group").append(error);
          },
          highlight: function (element, errorClass, validClass) {
            $(element).addClass("is-invalid");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass("is-invalid");
          },
        });
      });
    </script>

    <!--  Password update form validation with jquery validation -->
    <script>
      $(function () {
        $("#RepositoryItemForm").validate({
          rules: {
            ItemGroup: {
              required: true,
            },
            ItemTitle: {
              required: true,
            },
            ItemFile: {
              required: true,
            },
          },
          messages: {
            ItemGroup: {
              required: "Please select a repositoy",
            },
            ItemTitle: {
              required: "Please provide a title",
            },
            ItemFile: {
              required: "Please browse and upload a file",
            },
          },
          errorElement: "span",
          errorPlacement: function (error, element) {
            error.addClass("invalid-feedback");
            element.closest(".form-group").append(error);
          },
          highlight: function (element, errorClass, validClass) {
            $(element).addClass("is-invalid");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass("is-invalid");
          },
        });
      });
    </script>

    <!--  User admin form validation with jquery validation -->
    <script>
      $(function () {
        $("#UserAdminAccount").validate({
          rules: {
            FirstName: {
              required: true,
            },
            LastName: {
              required: true,
            },
            UserEmail: {
              required: true,
              email: true,
            },
            UserProfile: {
              required: true,
            },
          },
          messages: {
            FirstName: {
              required: "Please provide a first name",
            },
            LastName: {
              required: "Please provide a last name",
            },
            UserEmail: {
              required: "Please provide a email address",
              email: "Please enter a valid email address",
            },
            UserProfile: {
              required: "Please upload a user profile picture",
            },
          },
          errorElement: "span",
          errorPlacement: function (error, element) {
            error.addClass("invalid-feedback");
            element.closest(".form-group").append(error);
          },
          highlight: function (element, errorClass, validClass) {
            $(element).addClass("is-invalid");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass("is-invalid");
          },
        });
      });
    </script>

    <!--  User admin form validation with jquery validation -->
    <script>
      $(function () {
        $("#InitiativeAddForm").validate({
          rules: {
            InitiativeName: {
              required: true,
            },
            FoundationYear: {
              required: true,
            },
            InitiativeType: {
              required: true,
            },
            InitiativeOrigin: {
              required: true,
            },
            AriaOfFocus: {
              required: true,
            },
            OfficialLink: {
              required: true,
              url: true,
            },
          },
          messages: {
            InitiativeName: {
              required: "Please provide the name of the initiative",
            },
            FoundationYear: {
              required: "Please provide the year of foundation",
            },
            InitiativeType: {
              required: "Please provide the type of the initiative",
            },
            InitiativeOrigin: {
              required: "Please provide the origin of the initiative",
            },
            AriaOfFocus: {
              required: "Please provide the area of focus",
            },
            OfficialLink: {
              required: "Please provide the official link",
              url: "Please make sure it is a valid URL",
            },
          },
          errorElement: "span",
          errorPlacement: function (error, element) {
            error.addClass("invalid-feedback");
            element.closest(".form-group").append(error);
          },
          highlight: function (element, errorClass, validClass) {
            $(element).addClass("is-invalid");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass("is-invalid");
          },
        });
      });
    </script>

    <script>
      // Initialize tooltips
      var tooltipTriggerList = [].slice.call(
        document.querySelectorAll('[data-bs-toggle="tooltip"]')
      );
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
      });
    </script>

    <script>
      $(function () {
        //Initialize Select2 Elements
        $(".select2").select2();

        $(".select2bs4").select2({
          theme: "bootstrap4",
        });
      });
    </script>

    <script>
      // Initialize bsCustomFileInput
      $(document).ready(function () {
        bsCustomFileInput.init();
      });
    </script>

    <script>
      $(document).ready(function () {
        $("#myTable").DataTable({
          responsive: true,
          paging: true,
          searching: true,
          ordering: true,
          lengthChange: true,
          info: true,
          autoWidth: false,
          dom: 'Bfrtip',
          buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
          ]
        });
      });
    </script>

  </body>
</html>
