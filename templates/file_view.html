{% extends 'base.html' %} {% load static %} {% load custom_filters %} 
{% load humanize %} {% block 'main-section' %}
<section class="ftco-section ftco-no-pt">
  <div class="container">
    <!-- Breadcrumb Navigation -->
    <nav aria-label="breadcrumb" class="pt-4">
      <ol class="breadcrumb bg-transparent px-0">
        <li class="breadcrumb-item">
          <a href="{% url 'index' %}" class="text-decoration-none text-muted">
            <i class="bi bi-house-door-fill"></i> Home
          </a>
        </li>
        <li
          class="breadcrumb-item active text-dark fw-semibold"
          aria-current="page"
        >
          View File
        </li>
      </ol>
    </nav>

    <div class="row justify-content-center py-4" style="margin-top: -25px">
      <div class="col-md-1 heading-section text-center ftco-animate"></div>
    </div>
    <div class="row justify-content-center">
      <div class="col-md-12 mb-5">
        <div class="card">
          <div class="card-body d-flex flex-column">
            {% if error %}
            <div class="alert alert-danger" role="alert">{{ error }}</div>
            {% else %}
            <div class="row mb-4 text-center">
              <div class="col-6 col-md-3 mb-3">
                <div class="fw-bold">
                  <i class="fa fa-bars me-1 text-primary"></i> Rows
                </div>
                <div style="font-size: 17px">{{ rows|intcomma }}</div>
              </div>

              <div class="col-6 col-md-3 mb-3">
                <div class="fw-bold">
                  <i class="fa fa-th-large me-1 text-success"></i> Columns
                </div>
                <div style="font-size: 17px">{{ cols|intcomma }}</div>
              </div>

              <div class="col-6 col-md-3 mb-3">
                <div class="fw-bold">
                  <i class="fa fa-table me-1 text-warning"></i> Total Cells
                </div>
                <div style="font-size: 17px">{{ total_cells|intcomma }}</div>
              </div>

              <div class="col-6 col-md-3 mb-3">
                <div class="fw-semibold text-muted">
                  <i class="fa fa-file-alt me-1 text-info"></i> File name
                </div>
                <div style="font-size: 15px">{{ file_name }}</div>
              </div>
            </div>

            <hr />

            <h5
              class="mb-3 fw-bold text-muted d-flex flex-wrap align-items-center"
              style="font-size: 17px"
            >
              <i class="fa fa-info-circle me-2 text-primary"></i>
              Preview (First {{ preview_rows_shown }} rows)

              <span
                class="badge bg-secondary ms-3 mt-2 mt-sm-0"
                style="font-size: 0.8em"
              >
                <i class="fa fa-eye me-1"></i> {{ view_count|intcomma }} Views
              </span>

              <a
                href="{% url 'download-file' item.id %}"
                class="badge bg-success text-decoration-none ms-3 mt-2 mt-sm-0"
                style="font-size: 0.8em"
              >
                <i class="fa fa-download me-1"></i> Download
              </a>
            </h5>
            <div class="table-responsive">
              <table
                id="excelTable"
                class="table table-bordered table-striped dt-responsive"
                style="width: 100%"
              >
                <thead class="table-light">
                  <tr>
                    {% for col in preview_columns %}
                    <th scope="col">{{ col }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% for row in preview_records %}
                  <tr>
                    {% for col in preview_columns %}
                    <td>{{ row|get_item:col }}</td>
                    {% endfor %}
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
