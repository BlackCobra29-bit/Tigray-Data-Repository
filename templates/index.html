{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block 'main-section' %}
<section class="ftco-section ftco-no-pt">
    <div class="container">
        <div class="row justify-content-center py-4" style="margin-top: -25px;">
            <div class="col-md-1 heading-section text-center ftco-animate"></div>
        </div>
        <div class="row d-flex">
            <div class="col-md-12 pt-0">
                <div class="card h-100 shadow-none border-0">
                    <div class="card-body d-flex flex-column">
                        <div>
                            <h2 class="heading" style="font-size: 1.8rem; font-weight: bold;">{{ article.ArticleTitle }}</h2>
                            <p class="text-center" id="intro-text">
                                The Tigray Data Repository (TDR) is an online, open-source repository that documents
                                Tigray’s history and the experiences of Tigrayan communities in Tigray and the Diaspora.
                                The TDR, which was established in May 2024 and went live in April 2025, is a digital archive
                                of the life, struggles, and experiences of Tigrayans. The repository documents various datasets that provide an overview of the Tigrayan community and their experiences. From digital, humanitarian, and socio-economic aspects to cultural, political, and educational experiences, the TDR captures every facet of the Tigrayan lifestyle— providing us with a general
                                database for Tigray.
                                <br><br>
                                The TDR is a valuable resource for education and research that will promote accountability
                                for the genocide committed during the Tigray war (2020–2022) and benefit future generations. 
                                Guided by the motto: <i class="brand-text-color">“Data for Tigray, Knowledge for Generations!”</i>, the TDR will play a
                                pivotal role in creating awareness and advocating for humanitarian actions for Tigray.
                                <br><br>
                                Moreover, by demonstrating the past struggles and current journeys of the Tigrayan people,
                                TDR illuminates the community’s resilience, history, and identity. Our team aims to preserve
                                data for research and insight generation. This data will form the foundation for reformations
                                and empower the community with the knowledge to thrive and live harmoniously.
                            </p>
                            <br>
                            <div class="heading-container">
                                <span class="vertical-line"></span>
                                <h2 class="heading">Confidentiality and Privacy</h2>
                            </div>
                            <div class="underline"></div>
                            <br>
                            <p class="text-center" id="intro-text">
                                TDR is dedicated to safeguarding the confidence and trust of our users by adhering to
                                strict standards of confidentiality and privacy. We ensure that our datasets comply with
                                the safety standards per the international data protection rules and regulations and take
                                full responsibility for their maintenance. As our user, you can confidently explore and
                                engage with our platform freely and be assured that your contributions will be preserved
                                responsibly.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<hr>

<section class="ftco-section2 pt-custom">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 mb-5">
                <div class="card" id="slideFromLeft">
                    <div class="card-header bg-default text-white">
                        <h6 class="mb-0 fw-semibold d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center" style="color: #2E599D;">
                            
                            <strong class="mb-2 mb-md-0">Available Datasets</strong>
                            
                            <div class="d-flex flex-wrap gap-2 pe-md-3">
                            <span class="badge text-white" style="background-color: #2E599D; font-size: 0.8rem;">
                                <i class="fas fa-folder me-1"></i>
                                {{ parent_repositories_count }} Repositories
                            </span>
                            <span class="badge text-white" style="background-color: #2E599D; font-size: 0.8rem;">
                                <i class="fas fa-file-alt me-1"></i>
                                {{ total_repository_items }} Datasets
                            </span>
                            </div>

                        </h6>
                    </div>
                    <div class="card-body p-0">
                        <table class="table">
                            <tbody>
                                {% for group in repository_groups %}
                                <tr data-widget="expandable-table" aria-expanded="false">
                                    <td>
                                        <i class="expandable-table-caret fas fa-caret-right fa-fw"></i>
                                        <i class="fa fa-folder me-2" aria-hidden="true" style="font-size: 1.1rem; color: #2E599D;"></i>
                                        {{ group.name }}
                                    </td>
                                </tr>
                                <tr class="expandable-body">
                                    <td>
                                        <div class="p-0">
                                            {% if group.repository_items or group.subfolders %}
                                                <table class="table table-hover">
                                                    <tbody>
                                                        {% if group.subfolders %}
                                                        <!-- Subfolders -->
                                                        {% for subfolder in group.subfolders %}
                                                        <tr data-widget="expandable-table" aria-expanded="false">
                                                            <td class="ps-4">
                                                                <i class="expandable-table-caret fas fa-caret-right fa-fw"></i>
                                                                <i class="fa fa-folder-open me-2" style="color: #428bca;"></i>
                                                                {{ subfolder.name }}
                                                            </td>
                                                        </tr>
                                                        <tr class="expandable-body">
                                                            <td class="ps-5">
                                                                <div class="p-0">
                                                                    <table class="table table-hover">
                                                                        <tbody>
                                                                            {% for item in subfolder.repository_items %}
                                                                            <tr>
                                                                                <td class="text-sm"  class="ps-5">
                                                                                    {% with file_icon=item.file_name|get_file_icon %}
                                                                                    <i class="{{ file_icon.icon }} me-2" aria-hidden="true" style="color: {{ file_icon.color }};"></i>
                                                                                    {% endwith %}                                                                             
                                                                                    {{ item.file_name|normalize_readme  }}
                                                                                        <div class="float-right d-flex align-items-center">
                                                                                                {% if item.download_count > 0 %}
                                                                                                <span class="badge badge-secondary me-2" style="font-size: 0.8em;">
                                                                                                        {{ item.download_count }} Downloads
                                                                                                </span>
                                                                                                {% endif %}
                                                                                                <a href="{% url 'download-file' item.id %}" class="badge badge-success">
                                                                                                        <i class="fa fa-download me-1"></i>Download
                                                                                                </a>
                                                                                        </div>
                                                                                </td>
                                                                            </tr>
                                                                            {% empty %}
                                                                            <tr>
                                                                                <td class="text-muted">No files available in this subfolder.</td>
                                                                            </tr>
                                                                            {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% empty %}
                                                        <tr>
                                                            <td class="text-muted">No subfolders available for this repository group.</td>
                                                        </tr>
                                                        {% endfor %}
                                                        {% endif %}
                                                        
                                                        {% if group.repository_items %}
                                                        {% for item in group.repository_items %}
                                                        <tr>
                                                            <td class="ps-5">
                                                                <div class="text-sm">
                                                                    {% with file_icon=item.file_name|get_file_icon %}
                                                                    <i class="{{ file_icon.icon }} me-2" aria-hidden="true" style="color: {{ file_icon.color }};"></i>
                                                                    {% endwith %}
                                                                    {{ item.file_name|normalize_readme }}
                                                                    <div class="float-right d-flex align-items-center">
                                                                        {% if item.download_count > 0 %}
                                                                        <span class="badge badge-secondary me-2" style="font-size: 0.8em;">
                                                                            {{ item.download_count }} Downloads
                                                                        </span>
                                                                        {% endif %}
                                                                        <a href="{% url 'download-file' item.id %}" class="badge badge-success">
                                                                            <i class="fa fa-download me-1"></i>Download
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                        {% endif %}
                                                    </tbody>
                                                </table>
                                            {% else %}
                                            <div class="text-muted p-3">
                                                <i class="fa fa-info-circle me-2"></i>
                                                No datasets available for this repository.
                                            </div>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card" id="slideFromRight">
                    <div class="card-header bg-default text-white">
                        <h6 class="mb-0 fw-semibold" style="color: #2E599D;">From afar, for Tigray!</h6>
                    </div>
                    <div class="card-body">
                        <p class="card-text">
                            As part of our mission to document and preserve the stories of Tigray and its communities, we have created a database of Tigrayan diaspora initiatives and organizations.
                        </p>
                        <div class="d-flex justify-content-center">
                            <a href="{% url 'initiatives' %}" class="btn btn-primary">Read More...</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Page Specfic Animation Script -->
<script>
    // Slide in the card from the left
    gsap.from("#slideFromLeft", { x: -300, opacity: 0, duration: 1 });

    // Slide in the card from the right
    gsap.from("#slideFromRight", { x: 300, opacity: 0, duration: 1 });
</script>
{% endblock %}